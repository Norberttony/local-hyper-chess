{"version":3,"file":"pool.js","sourceRoot":"","sources":["../../graphics/pool.ts"],"names":[],"mappings":"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","sourcesContent":["import { getFENCharFromPieceType, Side, PieceType } from \"../index.js\";\n\n// handles generating elements to represent the pieces. Whenever a piece is taken, its element\n// is put into a pool for later use.\n\n// fetches an element from the pool\nexport function fetchElem(className: string, f: number, r: number, boardFlipped: boolean): HTMLElement {\n    let elem = document.getElementById(\"element-pool\");\n    if (!elem){\n        elem = document.createElement(\"div\");\n    }\n\n    elem.id = \"\";\n    setElemLocation(elem, f, r, boardFlipped);\n    elem.className = className;\n\n    return elem;\n}\n\n// sets the location of an element on the board\nexport function setElemLocation(elem: HTMLElement, f: number, r: number, boardFlipped: boolean): void {\n    elem.style.transform = `translate(${(boardFlipped ? 7 - f : f) * 100}%, ${(boardFlipped ? r : 7 - r) * 100}%)`;\n}\n\n// either creates a completely new move highlight, or fetches an unused element.\nexport function getMoveHighlightFromPool(f: number, r: number, boardFlipped: boolean): HTMLElement {\n    return fetchElem(\"board-graphics__move-highlight\", f, r, boardFlipped);\n}\n\n// either creates a completely new move highlight, or fetches an unused element.\nexport function getLastMoveHighlightFromPool(f: number, r: number, boardFlipped: boolean): HTMLElement {\n    return fetchElem(\"board-graphics__move-highlight--last\", f, r, boardFlipped);\n}\n\n// either creates a completely new piece, or fetches an unused element.\nexport function getPieceFromPool(f: number, r: number, boardFlipped: boolean, pieceType: PieceType, pieceSide: Side): HTMLElement {\n    let piece = fetchElem(\"board-graphics__piece\", f, r, boardFlipped);\n\n    const coords = `${f}_${r}`;\n    const fen = getFENCharFromPieceType(pieceType);\n\n    piece.dataset[\"coords\"] = coords;\n    piece.dataset[\"pieceType\"] = fen;\n    \n    piece.classList.add(coords);\n    piece.classList.add(`board-graphics__piece--type-${fen}`);\n    \n    piece.style.backgroundPositionY = pieceSide == Side.White ? \"0%\" : \"100%\";\n    \n    return piece;\n}\n\n// puts an element back into the pool.\nexport function setElemToPool(elem: HTMLElement): void {\n    elem.id = \"element-pool\";\n    elem.className = \"\";\n    elem.innerHTML = \"\";\n\n    for (const key in elem.dataset)\n        delete elem.dataset[key];\n\n    elem.onpointerdown = function(){}\n    elem.onpointerup = function(){}\n}\n\n// puts a class into the pool\nexport function setClassToPool(classSelector: string, container: HTMLElement): void {\n    let elems = container.getElementsByClassName(classSelector);\n    while (elems.length > 0)\n        setElemToPool(elems[0] as HTMLElement);\n}\n\n// puts all pieces back into the pool.\nexport function setAllPiecesToPool(container: HTMLElement): void {\n    setClassToPool(\"board-graphics__piece\", container);\n}\n\n// puts all highlights back into pool.\nexport function setAllMoveHighlightsToPool(container: HTMLElement): void {\n    setClassToPool(\"board-graphics__move-highlight\", container);\n}\n\n// puts all last move highlights back into pool.\nexport function setAllLastMoveHighlightsToPool(container: HTMLElement): void {\n    setClassToPool(\"board-graphics__move-highlight--last\", container);\n}\n\n// attaches a glyph to the piece element\nexport function attachGlyph(elem: HTMLElement, src: string): void {\n    const div = document.createElement(\"div\");\n    div.classList.add(\"glyph\");\n    div.style.backgroundImage = `url(${src})`;\n    elem.appendChild(div);\n}\n"]}