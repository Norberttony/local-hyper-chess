{"version":3,"file":"pgn-widget.js","sourceRoot":"","sources":["../../../graphics/widgets/pgn-widget.ts"],"names":[],"mappings":"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","sourcesContent":["\nimport { Side, StartingFEN } from \"../../index.js\";\nimport { BoardWidget, getFirstElemOfClass, WidgetLocation } from \"./board-widget.js\";\nimport { addPointerHoldListener } from \"../pgn/pgn-control.js\";\nimport type { BoardGraphics } from \"../board-graphics.js\";\nimport { VariationMove } from \"../pgn/variation.js\";\nimport { getResultTag } from \"../../pgn/index.js\";\n\n// handles displaying any of the moves in a separate panel, splitting the PGN into variations as\n// necessary.\n\n// The PGN list structure is a little complicated as it must allow a practically infinite nesting\n// of different variations, with a way to style main variation elements.\n\n//  <div class=\"pgn-viewer__pgn-list\">\n//      <div class=\"pgn-viewer__pgn-moveline\">\n//          <div class=\"pgn-viewer__pgn-elem pgn-viewer__pgn-elem--type-num\">1.</div>\n//          <div class=\"pgn-viewer__pgn-elem pgn-viewer__pgn-elem--type-san\">Pd4</div>\n//          <div class=\"pgn-viewer__pgn-elem pgn-viewer__pgn-elem--type-san\">Pf5</div>\n//      </div>\n//      <div class=\"pgn-viewer__pgn-moveline--type-variation\">\n//          <div class=\"pgn-viewer__pgn-elem pgn-viewer__pgn-elem--type-variation-line\">\n//              <div class=\"pgn-viewer__pgn-elem pgn-viewer__pgn-elem--type-san\">Pe3</div>\n//              <div class=\"pgn-viewer__pgn-elem pgn-viewer__pgn-elem--type-san\">Ph3</div>\n//          </div>\n//      </div>\n//  </div>\n\nexport class PGNWidget extends BoardWidget {\n    // determines the current next variation the user is selecting\n    private selectedVariation: number = 0;\n    private pgnElem: HTMLElement;\n    private resultElem?: HTMLElement;\n\n    constructor(boardgfx: BoardGraphics, location: WidgetLocation){\n        super(boardgfx);\n\n        const container = document.createElement(\"div\");\n        container.classList.add(\"pgn-viewer\");\n        boardgfx.getWidgetContainer(location).appendChild(container);\n\n        const pgnControl = document.createElement(\"div\");\n        pgnControl.classList.add(\"pgn-viewer__pgn-control\");\n        pgnControl.innerHTML = `\n            <button class = \"pgn-viewer__first\">&lt;&lt;</button>\n            <button class = \"pgn-viewer__back\">&lt;</button>\n            <button class = \"pgn-viewer__next\">&gt;</button>\n            <button class = \"pgn-viewer__last\">&gt;&gt;</button>`;\n        container.appendChild(pgnControl);\n\n        const back = pgnControl.getElementsByClassName(\"pgn-viewer__back\")[0] as HTMLElement;\n        addPointerHoldListener(back, () => {\n            this.PGNMoveBack();\n        });\n\n        const next = pgnControl.getElementsByClassName(\"pgn-viewer__next\")[0] as HTMLElement;\n        addPointerHoldListener(next, () => {\n            this.PGNMoveForward();\n        });\n\n        const first = pgnControl.getElementsByClassName(\"pgn-viewer__first\")[0] as HTMLElement;\n        first.addEventListener(\"click\", () => {\n            // displays position with no moves made on the board\n            this.PGNMoveFirst();\n        });\n\n        const last = pgnControl.getElementsByClassName(\"pgn-viewer__last\")[0] as HTMLElement;\n        last.addEventListener(\"click\", () => {\n            // displays position of the last committed move in the main variation\n            this.PGNMoveLast();\n        });\n\n        const pgnElem = document.createElement(\"div\");\n        // TO-DO: this should be here until the CSS class names are converted to a better format\n        pgnElem.classList.add(\"pgn-viewer__pgn-list\");\n        container.appendChild(pgnElem);\n\n        this.pgnElem = pgnElem;\n\n        // event listeners\n        boardgfx.skeleton.addEventListener(\"new-variation\", (event) => {\n            this.onNewVariation(event as CustomEvent);\n        });\n        boardgfx.skeleton.addEventListener(\"result\", (event) => {\n            this.onResult(event as CustomEvent);\n        });\n        boardgfx.skeleton.addEventListener(\"loadFEN\", (event) => {\n            this.onLoadFEN(event as CustomEvent);\n        });\n        boardgfx.skeleton.addEventListener(\"variation-change\", (event) => {\n            this.onVariationChange(event as CustomEvent);\n        });\n        boardgfx.skeleton.addEventListener(\"delete-variation\", (event) => {\n            this.onDeleteVariation(event as CustomEvent);\n        });\n\n        document.body.addEventListener(\"keydown\", (event) => this.keydown(event));\n    }\n\n    private keydown(event: KeyboardEvent){\n        if (event.target == this.boardgfx.skeleton){\n            switch (event.key.toLowerCase()){\n                case \"arrowleft\":\n                    this.PGNMoveBack();\n                    break;\n                case \"arrowright\":\n                    this.PGNMoveForward();\n                    break;\n                case \"arrowup\":\n                    this.PGNUpVariation();\n                    break;\n                case \"arrowdown\":\n                    this.PGNDownVariation();\n                    break;\n\n                case \"f\":\n                    this.boardgfx.flip();\n                    break;\n\n                // if no bound key was hit, do not prevent event default.\n                default:\n                    return;\n            }\n            event.preventDefault();\n        }\n    }\n\n    private PGNMoveBack(): void {\n        if (this.boardgfx.previousVariation())\n            this.boardgfx.applyChanges();\n        this.selectedVariation = 0;\n    }\n\n    private PGNMoveForward(): void {\n        if (this.boardgfx.nextVariation(this.selectedVariation))\n            this.boardgfx.applyChanges();\n        this.selectedVariation = 0;\n    }\n\n    private PGNUpVariation(): void {\n        this.selectedVariation--;\n        if (this.selectedVariation < 0)\n            this.selectedVariation = this.boardgfx.currentVariation.next.length - 1;\n    }\n\n    private PGNDownVariation(): void {\n        const max = this.boardgfx.currentVariation.next.length;\n        this.selectedVariation = (this.selectedVariation + 1) % max;\n    }\n\n    private PGNMoveFirst(): void {\n        // displays position with no moves made on the board\n        this.boardgfx.jumpToVariation(this.boardgfx.variationRoot);\n        this.boardgfx.applyChanges();\n    }\n\n    private PGNMoveLast(): void {\n        // displays position of the last committed move in the main variation\n        let iter = this.boardgfx.currentVariation;\n        while (iter.next[0]){\n            iter = iter.next[0];\n        }\n\n        this.boardgfx.jumpToVariation(iter);\n        this.boardgfx.applyChanges();\n    }\n\n    private onNewVariation(event: CustomEvent): void {\n        const { variation } = event.detail;\n\n        // determine move number\n        const moveNum = variation.fullMoveNum;\n\n        // determine the player who made this move\n        const turn = variation.turn;\n\n        // create a new SAN elem for this variation\n        const sanElem = newSANElem(this.boardgfx, this.pgnElem, variation.san, variation);\n        variation.element = sanElem;\n\n        if (variation.isMain()){\n            if (turn == Side.Black){\n                // add this move to the previous move line\n                const prevMoveline = variation.prev.element.parentNode;\n                prevMoveline.appendChild(sanElem);\n\n                // if the next element does not exist or is not a moveline, this must be the very end\n                // of the pgn and a skip is required.\n                const nextElem = prevMoveline.nextElementSibling;\n                if (prevMoveline.getElementsByClassName(\"pgn-viewer__pgn-elem--type-blank\")[0]){\n                    // fetch next available moveline\n                    let nextMovelineElem = nextElem;\n                    while (!nextMovelineElem.classList.contains(\"pgn-viewer__pgn-moveline\")){\n                        nextMovelineElem = nextMovelineElem.nextElementSibling;\n                    }\n\n                    if (nextMovelineElem){\n                        nextMovelineElem.appendChild(sanElem);\n                    }\n                }else if (nextElem && !isPGNSpecialBlock(nextElem)){\n                    const blankSANElem = newBlankSANElem(this.boardgfx, this.pgnElem);\n                    prevMoveline.appendChild(blankSANElem);\n\n                    const moveline = newMovelineElem(moveNum, newBlankSANElem(this.boardgfx, this.pgnElem));\n                    moveline.appendChild(sanElem);\n\n                    // insert either after the special elements or just at the end.\n                    if (!nextElem || !nextElem.nextElementSibling){\n                        this.pgnElem.appendChild(moveline);\n                    }else{\n                        // keep searching for the next moveline element\n                        let nextMoveline = nextElem;\n                        while (nextMoveline && !nextMoveline.classList.contains(\"pgn-viewer__pgn-moveline\"))\n                            nextMoveline = nextMoveline.nextElementSibling;\n\n                        // either moveline exists or we've reached the end of the pgn\n                        if (nextMoveline)\n                            this.pgnElem.insertBefore(moveline, nextMoveline);\n                        else\n                            this.pgnElem.appendChild(moveline);\n                    }\n                }\n            }else{\n                // create a new move line for this variation\n                const moveline = newMovelineElem(moveNum, sanElem);\n                const resultElem = document.getElementsByClassName(\"pgn-viewer__pgn-elem--type-result\")[0];\n                if (resultElem)\n                    this.pgnElem.insertBefore(moveline, resultElem);\n                else\n                    this.pgnElem.appendChild(moveline);\n            }\n        }else{\n\n            if (variation.location == 0){\n                // same variation line\n                const variationElem = variation.prev.element.parentNode;\n                variationElem.appendChild(sanElem);\n            }else{\n                // create a new variation object to contain all of the variations after the previous\n                // moveline\n                const variationLineElem = document.createElement(\"div\");\n                variationLineElem.classList.add(\"pgn-viewer__pgn-elem\", \"pgn-viewer__pgn-elem--type-variation-line\");\n\n                variationLineElem.appendChild(sanElem);\n                \n                let previousContainer = variation.prev.next[0].element.parentNode;\n\n                if (previousContainer.classList.contains(\"pgn-viewer__pgn-moveline\")){\n                    const nextElem = previousContainer.nextElementSibling;\n                    // do we split the moveline or not?\n                    if (turn == Side.White){\n                        // split!!!\n                        if (nextElem && nextElem.classList.contains(\"pgn-viewer__pgn-elem--type-variation\")){\n                            nextElem.appendChild(variationLineElem);\n                        }else{\n                            const variationElem = newVariationElem();\n                            variationElem.appendChild(variationLineElem);\n\n                            const [ m1, m2 ] = splitMovelineElem(this.boardgfx, this.pgnElem, previousContainer);\n                            if (m1 && m2 && m1.parentNode)\n                                m1.parentNode.insertBefore(variationElem, m2);\n                        }\n                    }else{\n                        const variationElem = newVariationElem();\n                        variationElem.appendChild(variationLineElem);\n\n                        // no split needed, just insert after moveline\n                        if (nextElem)\n                            this.pgnElem.insertBefore(variationElem, nextElem);\n                        else\n                            this.pgnElem.appendChild(variationElem);\n                    }\n                }else{\n                    // this must be another simple variation element, so let's just add a variation to the variation\n                    const variationElem = newVariationElem();\n                    variationElem.appendChild(variationLineElem);\n                    \n                    previousContainer.appendChild(variationElem);\n                }\n            }\n        }\n    }\n\n    private onResult(event: CustomEvent): void {\n        const { winner, termination } = event.detail;\n\n        // based on the result number, add some result text and flavor text\n        const result = getResultTag(winner);\n        const resultText = result.split(\"-\").join(\" - \");\n        let flavorText;\n        if (result == \"1/2-1/2\"){\n            flavorText = \"Game ended by\";\n        }else if (result == \"0-1\"){\n            flavorText = \"Black wins by\";\n        }else if (result == \"1-0\"){\n            flavorText = \"White wins by\";\n        }\n\n        // displays result\n        if (!this.resultElem || !this.resultElem.parentNode){\n            const pgn_resultElem = document.createElement(\"div\");\n            pgn_resultElem.classList.add(\"pgn-viewer__pgn-elem\", \"pgn-viewer__pgn-elem--type-result\");\n            this.pgnElem.appendChild(pgn_resultElem);\n            this.resultElem = pgn_resultElem;\n        }\n        this.resultElem.innerHTML = `<span>${resultText}</span><br /><span style = \"font-size: large;\">${flavorText} ${termination}</span>`;\n        this.boardgfx.pgnData.setHeader(\"Result\", resultText);\n    }\n\n    private onLoadFEN(event: CustomEvent): void {\n        const { fen } = event.detail;\n    \n        // none of the previous PGN is relevant to this new position, so...\n        this.pgnElem.innerHTML = \"\";\n        this.boardgfx.pgnData.clear();\n    \n        if (fen.replace(/ /g, \"\") != StartingFEN.replace(/ /g, \"\")){\n            this.boardgfx.pgnData.setHeader(\"Variant\", \"From Position\");\n            this.boardgfx.pgnData.setHeader(\"FEN\", fen);\n        }\n    }\n    \n    private onVariationChange(event: CustomEvent): void {\n        const { variation } = event.detail;\n    \n        selectPGNElem(this.pgnElem, variation.element);\n    }\n\n    private onDeleteVariation(event: CustomEvent): void {\n        const { variation } = event.detail;\n\n        if (variation == this.boardgfx.mainVariation && this.resultElem && this.resultElem.parentNode){\n            this.resultElem.parentNode.removeChild(this.resultElem);\n            delete this.resultElem;\n        }\n\n        this.deletePGNElement(variation.element);\n    }\n\n    private deletePGNElement(elem: HTMLElement): void {\n        const parent = elem.parentNode as HTMLElement;\n        if (parent){\n            parent.removeChild(elem);\n\n            // if the moveline no longer contains any moves, it's useless and should be removed.\n            if (!getFirstElemOfClass(parent, \"pgn-viewer__pgn-elem--type-san\"))\n                parent.parentNode!.removeChild(parent);\n        }\n    }\n}\n\n\nfunction selectPGNElem(pgnElem: HTMLElement, elem: HTMLElement): void {\n    (document.getElementsByClassName(\"pgn-viewer__pgn-elem--selected\")[0] || elem || document.body).classList.remove(\"pgn-viewer__pgn-elem--selected\");\n    if (elem){\n        elem.classList.add(\"pgn-viewer__pgn-elem--selected\");\n        \n        // scrolls to selected pgn\n        let pgnRect = pgnElem.getBoundingClientRect();\n        let elemRect = elem.getBoundingClientRect();\n        let elemPos = elemRect.top - pgnRect.top; // element's position relative to the PGN scroll view\n\n        // already in view! don't scroll!\n        if (elemPos > 0 && elemPos + elemRect.height < pgnRect.height)\n            return;\n\n        // determine direction of scroll\n        if (elemPos <= 0){\n            // so we've scrolled past element, set it to top (as that is first occurrence)\n            pgnElem.scrollBy(0, elemRect.top - pgnRect.top);\n        }else{\n            pgnElem.scrollBy(0, elemRect.bottom - pgnRect.bottom);\n        }\n    }else{\n        pgnElem.scrollTo(0, 0);\n    }\n}\n\n// creates and returns the new moveline with the given number and white elem.\nfunction newMovelineElem(num: number, whiteSANElem: HTMLElement): HTMLDivElement {\n    const moveline = document.createElement(\"div\");\n\n    moveline.classList.add(\"pgn-viewer__pgn-moveline\");\n\n    const numElem = document.createElement(\"div\");\n    numElem.classList.add(\"pgn-viewer__pgn-elem\", \"pgn-viewer__pgn-elem--type-num\");\n    numElem.innerText = `${num}.`;\n    \n    moveline.appendChild(numElem);\n    moveline.appendChild(whiteSANElem);\n\n    return moveline;\n}\n\n// returns a list of two elements, the first moveline element and the second moveline element\n// if the given moveline elem is already split, this returns an empty list.\nfunction splitMovelineElem(gameState: BoardGraphics, pgnElem: HTMLElement, movelineElem: HTMLElement): HTMLElement[] {\n    // cannot split a moveline that is already split.\n    if (movelineElem.classList.contains(\"pgn_split-moveline\"))\n        return [];\n\n    movelineElem.classList.add(\"pgn_split-moveline\");\n\n    const elem1 = movelineElem;\n\n    const numText = (elem1.getElementsByClassName(\"pgn-viewer__pgn-elem--type-num\")[0] as HTMLElement).innerText;\n    const elem2 = newMovelineElem(parseInt(numText.substring(0, numText.length - 1)), newBlankSANElem(gameState, pgnElem));\n\n    const nextElem = elem1.nextElementSibling;\n    if (nextElem)\n        nextElem.parentNode!.insertBefore(elem2, nextElem);\n    else\n        elem1.parentNode!.appendChild(elem2);\n\n    // swap the second move elem in the first moveline with a blank elem\n    const blackMove = elem1.getElementsByClassName(\"pgn-viewer__pgn-elem--type-san\")[1];\n    if (blackMove){\n        elem2.appendChild(blackMove);\n    }\n    elem1.appendChild(newBlankSANElem(gameState, pgnElem));\n\n    return [ elem1, elem2 ];\n}\n\nfunction newSANElem(gameState: BoardGraphics, pgnElem: HTMLElement, san: string, variation?: VariationMove): HTMLDivElement {\n    const div = document.createElement(\"div\");\n    div.classList.add(\"pgn-viewer__pgn-elem\", \"pgn-viewer__pgn-elem--type-san\");\n    div.innerText = san;\n\n    if (variation){\n        div.addEventListener(\"click\", () => {\n            gameState.jumpToVariation(variation);\n            gameState.applyChanges();\n            selectPGNElem(pgnElem, div);\n        });\n    }\n\n    return div;\n}\n\nfunction newBlankSANElem(gameState: BoardGraphics, pgnElem: HTMLElement): HTMLDivElement {\n    const div = newSANElem(gameState, pgnElem, \"...\");\n    div.classList.add(\"pgn-viewer__pgn-elem\", \"pgn-viewer__pgn-elem--type-blank\");\n    return div;\n}\n\nfunction newVariationElem(): HTMLDivElement {\n    const div = document.createElement(\"div\");\n    div.classList.add(\"pgn-viewer__pgn-elem\", \"pgn-viewer__pgn-elem--type-variation\");\n    return div;\n}\n\nfunction isPGNSpecialBlock(elem: HTMLElement): boolean {\n    return elem.classList.contains(\"pgn-viewer__pgn-moveline\") || elem.classList.contains(\"pgn-viewer__pgn-elem--type-result\");\n}\n"]}